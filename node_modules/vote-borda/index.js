var createScoreMap = function createScoreMap(candidates){
    var scores = {}; 
    candidates.forEach(function(candidate){
        scores[candidate] = 0;
    });

    return scores;
};

var f = function f(cand,rank){
    return cand.length - rank; 
};

module.exports = function borda(profile,cb){
    var trie = profile.data;
    var scores = createScoreMap(profile._candidates);
    var queue = [];
    queue.unshift(trie);
    while (queue.length){
        node = queue.pop();
	if (node.name){
	    scores[node.name] += f(profile._candidates,node.rank) * node.numVotes; 
        }
	for (var child in node.children){
	    queue.unshift(node.children[child]);
	}
    }

    cb(scores);
};


